[gd_resource type="ShaderMaterial" load_steps=2 format=2]

[sub_resource type="Shader" id=1]
code = "shader_type spatial;

uniform bool isMouseOn = false;
uniform vec4 albedo : hint_color;
uniform vec4 edge_albedo : hint_color;
//uniform float fresnel_power = 15.0;
//uniform float edge_intensity = 10.0;
//uniform float fill_amount : hint_range(0, 1) = 0.1;
//
//uniform float proximity_crop_distance : hint_range(0, 1) = 0.01;
//uniform float proximity_fade_distance : hint_range(0, 1) = 0.05;
//uniform float proximity_clamp : hint_range(0, 1, 1) = 1;
//
uniform float scanline_period = 0.5;
uniform float scanline_width : hint_range(0, 0.49) = 0.1;
uniform float scanline_intensity = 0.35;
//
uniform float pattern_scroll_speed = 0.025;
//uniform vec2 pattern_uv_offset = vec2(6.0, 3.0);
//uniform float pattern_scale = 0.1;
//
//uniform sampler2D pattern_texture : hint_albedo;

//void vertex() {
//	VERTEX += NORMAL * 0.001;
//}

void fragment() {
	//Create a fresnel effect from the NORMAL and VIEW vectors.
//	float fresnel = pow(1.0 - dot(NORMAL, VIEW), fresnel_power) * edge_intensity;
	
	//Add back transparency in the middle
//	fresnel = fresnel + fill_amount;
	
	//Calculate UV scrolling pattern
	float scrolling_time = TIME * pattern_scroll_speed;
//	vec4 pattern = vec4(1) - texture(pattern_texture, (UV * pattern_uv_offset / pattern_scale) + vec2(scrolling_time));
	
//	fresnel *= pattern.r;
	
	float uv_offset = mod(-TIME * scanline_period, 2.0) - 1.0;
	float scanline = smoothstep(0.5 - scanline_width, 0.5, UV.y + uv_offset) * (1.0 - smoothstep(0.5, 0.5 + scanline_width, UV.y + uv_offset)); // * pattern.r;
	
	float emitFloor = 0.0;
	if (isMouseOn) {
		emitFloor = 0.15;
	}
	
	ALBEDO = albedo.rgb;
	EMISSION = edge_albedo.rgb * clamp(smoothstep(0, 1, scanline * scanline_intensity), emitFloor, 1);
}"

[resource]
shader = SubResource( 1 )
shader_param/isMouseOn = false
shader_param/albedo = Color( 0.121569, 0.121569, 0.286275, 1 )
shader_param/edge_albedo = Color( 0.231373, 1, 1, 1 )
shader_param/scanline_period = 0.5
shader_param/scanline_width = 0.333
shader_param/scanline_intensity = 0.35
shader_param/pattern_scroll_speed = 0.025
